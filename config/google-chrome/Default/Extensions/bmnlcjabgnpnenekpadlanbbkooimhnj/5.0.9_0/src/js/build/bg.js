function AzLock(){var e="coupon";forge.request.get("http://www.amazon.com/gp/cart/view.html/ref=nav_cart",function(t){var r=0,n=0;t.match(/\&a1=([^&]*)/)&&(r=t.match(/\&a1=([^&]*)/)[1]||0),t.match(/\&a2=([^&]*)/)&&(n=t.match(/\&a2=([^&]*)/)[1]||0);var i="";if(parseInt(r)){var o=CryptoJS.SHA256(r).toString();i+=o+"."}if(parseInt(n)){var s=CryptoJS.SHA256(n).toString();i+=s+"."}var a=CryptoJS.SHA256(i+pns_service+bg_tid.user.merchant+e).toString();getVersion(function(e){var t={exv:e,ss0:a,ss1:o,ss2:s};forge.request.ajax({url:data_api+"/ev/usr003001",type:"POST",contentType:"application/json",data:JSON.stringify({src:"extension",event:t})})})})}function getVersion(e){forge.prefs.get(user_id_key,function(t){forge.prefs.get(device_id_key,function(r){var n=getPlatform(),i=honey_version,o=n+"."+i+"."+t+"."+r;e(o)})})}function getPlatform(){var e=navigator.userAgent,t="";return t=e.match(/Discover\//)?"DI":e.match(/OPR\//)?"OP":forge.is.chrome()?"CH":forge.is.firefox()?"FF":forge.is.safari()?"SF":forge.is.ie()?"IE":"NA"}function ID_client(){}function getNewHoneyID(){var e=honey_id_client.honey_id.create();return e}function getDeviceID(e,t){try{parseInt(honey_device_id)?e&&e(honey_device_id):forge.prefs.get(device_id_key,function(r){parseInt(honey_device_id)?e&&e(honey_device_id):parseInt(r)?e&&e(honey_device_id=r):(honey_device_id=getNewHoneyID(),forge.prefs.set(device_id_key,honey_device_id,function(){e&&e(honey_device_id)},function(e){honey_device_id=null,t&&t(e)}))},function(e){t&&t(e)})}catch(r){t&&t(r)}}function getUserID(e,t,r){try{parseInt(honey_user_id)?t&&t(honey_user_id):forge.prefs.get(savehoney_id_key,function(n){parseInt(n)?(console.log("got savehoney_id key "+n),t(honey_user_id=n)):getChromeSyncID(user_id_key,function(){t&&t(honey_user_id)},function(){parseInt(honey_user_id)?t&&t(honey_user_id):forge.prefs.get(user_id_key,function(n){parseInt(honey_user_id)?t&&t(honey_user_id):parseInt(n)?t&&t(honey_user_id=n):(honey_user_id=getNewHoneyID(),forge.prefs.set(user_id_key,honey_user_id,function(){if(forge.is.chrome()){var n={};n[user_id_key]=honey_user_id,chrome.storage.sync.set(n,function(){chrome.runtime.lastError?(honey_user_id=null,forge.prefs.clear(user_id_key),r&&r(chrome.runtime.lastError)):(t&&t(honey_user_id),sendNewIDs(honey_device_id,honey_user_id,e))})}else t&&t(honey_user_id),sendNewIDs(honey_device_id,honey_user_id,e)},function(e){honey_user_id=null,r&&r(e)}))},function(e){honey_user_id=null,r&&r(e)})})})}catch(n){r&&r(n)}}function getChromeSyncID(e,t,r){forge.is.chrome()?chrome.storage.sync.get(e,function(n){parseInt(n[e])?(honey_user_id=n[e],t(honey_user_id)):r()}):r()}function sendNewIDs(e,t,r){var n=api_url+"/extusers",i="?v="+r.platform+"."+r.version+"."+t+"."+e;install_id&&(i+="&i="+install_id,install_id=null),forge.message.broadcast("debug",n+i),forge.request.get(n+i),forge.request.get("https://data.joinhoney.com/extdata/ckdata",function(n){var i=JSON.parse(n.referrer||"{}"),o=JSON.parse(n.honeycampaign||"{}"),s=null;if(n.gab){var i=n.gab.split(":")[0],a=n.gab.split(":")[1];s={enabled:!0,referrer:i,referee:a}}var u=r.platform+"."+r.version+"."+t+"."+e,c={exv:u};s&&(c.gab=s),i.referrer&&(c.referral_url=i.referrer),o.campaign&&(c.campaign={track_id:o.tid,id:o.campaign,token:o.token}),n.visitor&&(c.user={visitor_id:n.visitor}),forge.request.ajax({url:data_api+"/ev/ext000101",type:"POST",contentType:"application/json",data:JSON.stringify({src:"extension",event:c})})})}function setChromeSyncKey(e,t,r,n){if(forge.is.chrome()){var i={};i[e]=t,chrome.storage.sync.set(i,r)}else n()}function send800(e){forge.prefs.get("user_settings",function(t){(!t||t.prod_view_allowed)&&(batch_start=(new Date).getTime(),data={v:version,pdata:e},forge.request.ajax({type:"POST",url:data_api+"/he800",data:JSON.stringify(data),contentType:"application/json",success:function(e){forge.message.toFocussed("post_result",e)},error:function(e){forge.message.toFocussed("post_result",e)}}))}),batch_array=[]}var honey_user_id="0",honey_device_id="0",install_id=null,honey_version="5.0.9",bg_tid={user:{merchant:"merch"}},user_id_key="honey_userID",device_id_key="pns_deviceID",savehoney_id_key="savehoney_userID",api_url="https://data.joinhoney.com",pns_service="pns_";forge.prefs.get(device_id_key,function(e){null==e?forge.request.get(api_url+"/extdata/ckdata",function(e){forge.prefs.get("welcome_page_shown",function(t){var r=navigator.userAgent;t||r.match(/Discover\//)||(install_id=getNewHoneyID(),forge.request.get(api_url+"/extusers/install?i="+install_id),e.gab?forge.request.get(api_url+"/users",function(e){forge.tabs.open("http://joinhoney.com/welcome",!1)},function(e){forge.tabs.open("https://amazon.com?htt=1"),forge.prefs.set("gab_allowed",!0)}):forge.tabs.open("http://joinhoney.com/welcome",!1),forge.prefs.set("welcome_page_shown",!0))})}):forge.prefs.get("h_vers",function(e){if(e){{var t=parseInt(e.split(".")[0]),r=parseInt(e.split(".")[1]);parseInt(e.split(".")[2])}4>=t&&1>=r&&forge.prefs.get("az_lock",function(e){e||(forge.prefs.set("az_lock",!0),AzLock())})}})});var honey_id_client=new ID_client;forge.message.listen("get_user_and_device",function(e){try{getDeviceID(function(t){getUserID(e,function(e){forge.message.broadcast("user_and_device_response",{device_id:t,user_id:e})},function(e){forge.message.broadcast("error",e.message)})},function(e){forge.message.broadcast("error",e.message)})}catch(t){forge.message.broadcast("error",t.message)}}),forge.message.listen("set_savehoney_user_id",function(e){if(honey_user_id=e,forge.is.chrome()){var t={};t[user_id_key]=e,chrome.storage.sync.set(t,function(){chrome.runtime.lastError})}forge.prefs.set(savehoney_id_key,e,function(){console.log("successfully set"+e)})}),function e(t,r,n){function i(s,a){if(!r[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=r[s]={exports:{}};t[s][0].call(c.exports,function(e){var r=t[s][1][e];return i(r?r:e)},c,c.exports,e,t,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,r){(function(){var t;t=e("long"),ID_client.prototype.honey_id={create:function(e){var r,n,i;return e=parseInt(e)||99,i=10*(new Date).getTime(),r=Math.floor(255*Math.random()),n=2047&r,(new t).add(i).shiftLeft(11).and(new t(4294965248,4294967295)).add(n).shiftLeft(8).and(new t(4294967280,4294967295)).add(e).toString(10)}}}).call(this)},{"long":3}],2:[function(e,t,r){!function(n){"use strict";var i=function(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r};i.isLong=function(e){return(e&&e instanceof i)===!0};var o={},s={};i.fromInt=function(e,t){var r,n;return t?(e>>>=0,e>=0&&256>e&&(n=s[e])?n:(r=new i(e,0>(0|e)?-1:0,!0),e>=0&&256>e&&(s[e]=r),r)):(e=0|e,e>=-128&&128>e&&(n=o[e])?n:(r=new i(e,0>e?-1:0,!1),e>=-128&&128>e&&(o[e]=r),r))},i.fromNumber=function(e,t){return t=!!t,isNaN(e)||!isFinite(e)?i.ZERO:!t&&-f>=e?i.MIN_VALUE:!t&&e+1>=f?i.MAX_VALUE:t&&e>=h?i.MAX_UNSIGNED_VALUE:0>e?i.fromNumber(-e,t).negate():new i(e%c|0,e/c|0,t)},i.fromBits=function(e,t,r){return new i(e,t,r)},i.fromString=function(e,t,r){if(0===e.length)throw Error("number format error: empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return i.ZERO;if("number"==typeof t&&(r=t,t=!1),r=r||10,2>r||r>36)throw Error("radix out of range: "+r);var n;if((n=e.indexOf("-"))>0)throw Error('number format error: interior "-" character: '+e);if(0===n)return i.fromString(e.substring(1),t,r).negate();for(var o=i.fromNumber(Math.pow(r,8)),s=i.ZERO,a=0;a<e.length;a+=8){var u=Math.min(8,e.length-a),c=parseInt(e.substring(a,a+u),r);if(8>u){var h=i.fromNumber(Math.pow(r,u));s=s.multiply(h).add(i.fromNumber(c))}else s=s.multiply(o),s=s.add(i.fromNumber(c))}return s.unsigned=t,s},i.fromValue=function(e){return"number"==typeof e?i.fromNumber(e):"string"==typeof e?i.fromString(e):i.isLong(e)?e:new i(e.low,e.high,e.unsigned)};var a=65536,u=1<<24,c=a*a,h=c*c,f=h/2,g=i.fromInt(u);i.ZERO=i.fromInt(0),i.UZERO=i.fromInt(0,!0),i.ONE=i.fromInt(1),i.UONE=i.fromInt(1,!0),i.NEG_ONE=i.fromInt(-1),i.MAX_VALUE=i.fromBits(-1,2147483647,!1),i.MAX_UNSIGNED_VALUE=i.fromBits(-1,-1,!0),i.MIN_VALUE=i.fromBits(0,-2147483648,!1),i.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},i.prototype.toNumber=function(){return this.unsigned?(this.high>>>0)*c+(this.low>>>0):this.high*c+(this.low>>>0)},i.prototype.toString=function(e){if(e=e||10,2>e||e>36)throw RangeError("radix out of range: "+e);if(this.isZero())return"0";var t;if(this.isNegative()){if(this.equals(i.MIN_VALUE)){var r=i.fromNumber(e),n=this.div(r);return t=n.multiply(r).subtract(this),n.toString(e)+t.toInt().toString(e)}return"-"+this.negate().toString(e)}var o=i.fromNumber(Math.pow(e,6),this.unsigned);t=this;for(var s="";;){var a=t.div(o),u=t.subtract(a.multiply(o)).toInt()>>>0,c=u.toString(e);if(t=a,t.isZero())return c+s;for(;c.length<6;)c="0"+c;s=""+c+s}},i.prototype.getHighBits=function(){return this.high},i.prototype.getHighBitsUnsigned=function(){return this.high>>>0},i.prototype.getLowBits=function(){return this.low},i.prototype.getLowBitsUnsigned=function(){return this.low>>>0},i.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(i.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},i.prototype.isZero=function(){return 0===this.high&&0===this.low},i.prototype.isNegative=function(){return!this.unsigned&&this.high<0},i.prototype.isPositive=function(){return this.unsigned||this.high>=0},i.prototype.isOdd=function(){return 1===(1&this.low)},i.prototype.isEven=function(){return 0===(1&this.low)},i.prototype.equals=function(e){return i.isLong(e)||(e=i.fromValue(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low},i.prototype.notEquals=function(e){return i.isLong(e)||(e=i.fromValue(e)),!this.equals(e)},i.prototype.lessThan=function(e){return i.isLong(e)||(e=i.fromValue(e)),this.compare(e)<0},i.prototype.lessThanOrEqual=function(e){return i.isLong(e)||(e=i.fromValue(e)),this.compare(e)<=0},i.prototype.greaterThan=function(e){return i.isLong(e)||(e=i.fromValue(e)),this.compare(e)>0},i.prototype.greaterThanOrEqual=function(e){return this.compare(e)>=0},i.prototype.compare=function(e){if(this.equals(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.subtract(e).isNegative()?-1:1},i.prototype.negate=function(){return!this.unsigned&&this.equals(i.MIN_VALUE)?i.MIN_VALUE:this.not().add(i.ONE)},i.prototype.add=function(e){i.isLong(e)||(e=i.fromValue(e));var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,o=65535&this.low,s=e.high>>>16,a=65535&e.high,u=e.low>>>16,c=65535&e.low,h=0,f=0,g=0,l=0;return l+=o+c,g+=l>>>16,l&=65535,g+=n+u,f+=g>>>16,g&=65535,f+=r+a,h+=f>>>16,f&=65535,h+=t+s,h&=65535,i.fromBits(g<<16|l,h<<16|f,this.unsigned)},i.prototype.subtract=function(e){return i.isLong(e)||(e=i.fromValue(e)),this.add(e.negate())},i.prototype.multiply=function(e){if(this.isZero())return i.ZERO;if(i.isLong(e)||(e=i.fromValue(e)),e.isZero())return i.ZERO;if(this.equals(i.MIN_VALUE))return e.isOdd()?i.MIN_VALUE:i.ZERO;if(e.equals(i.MIN_VALUE))return this.isOdd()?i.MIN_VALUE:i.ZERO;if(this.isNegative())return e.isNegative()?this.negate().multiply(e.negate()):this.negate().multiply(e).negate();if(e.isNegative())return this.multiply(e.negate()).negate();if(this.lessThan(g)&&e.lessThan(g))return i.fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,o=65535&this.low,s=e.high>>>16,a=65535&e.high,u=e.low>>>16,c=65535&e.low,h=0,f=0,l=0,d=0;return d+=o*c,l+=d>>>16,d&=65535,l+=n*c,f+=l>>>16,l&=65535,l+=o*u,f+=l>>>16,l&=65535,f+=r*c,h+=f>>>16,f&=65535,f+=n*u,h+=f>>>16,f&=65535,f+=o*a,h+=f>>>16,f&=65535,h+=t*c+r*u+n*a+o*s,h&=65535,i.fromBits(l<<16|d,h<<16|f,this.unsigned)},i.prototype.div=function(e){if(i.isLong(e)||(e=i.fromValue(e)),e.isZero())throw new Error("division by zero");if(this.isZero())return this.unsigned?i.UZERO:i.ZERO;var t,r,n;if(this.equals(i.MIN_VALUE)){if(e.equals(i.ONE)||e.equals(i.NEG_ONE))return i.MIN_VALUE;if(e.equals(i.MIN_VALUE))return i.ONE;var o=this.shiftRight(1);return t=o.div(e).shiftLeft(1),t.equals(i.ZERO)?e.isNegative()?i.ONE:i.NEG_ONE:(r=this.subtract(e.multiply(t)),n=t.add(r.div(e)))}if(e.equals(i.MIN_VALUE))return this.unsigned?i.UZERO:i.ZERO;if(this.isNegative())return e.isNegative()?this.negate().div(e.negate()):this.negate().div(e).negate();if(e.isNegative())return this.div(e.negate()).negate();for(n=i.ZERO,r=this;r.greaterThanOrEqual(e);){t=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(t)/Math.LN2),a=48>=s?1:Math.pow(2,s-48),u=i.fromNumber(t),c=u.multiply(e);c.isNegative()||c.greaterThan(r);)t-=a,u=i.fromNumber(t,this.unsigned),c=u.multiply(e);u.isZero()&&(u=i.ONE),n=n.add(u),r=r.subtract(c)}return n},i.prototype.modulo=function(e){return i.isLong(e)||(e=i.fromValue(e)),this.subtract(this.div(e).multiply(e))},i.prototype.not=function(){return i.fromBits(~this.low,~this.high,this.unsigned)},i.prototype.and=function(e){return i.isLong(e)||(e=i.fromValue(e)),i.fromBits(this.low&e.low,this.high&e.high,this.unsigned)},i.prototype.or=function(e){return i.isLong(e)||(e=i.fromValue(e)),i.fromBits(this.low|e.low,this.high|e.high,this.unsigned)},i.prototype.xor=function(e){return i.isLong(e)||(e=i.fromValue(e)),i.fromBits(this.low^e.low,this.high^e.high,this.unsigned)},i.prototype.shiftLeft=function(e){return i.isLong(e)&&(e=e.toInt()),0===(e&=63)?this:32>e?i.fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):i.fromBits(0,this.low<<e-32,this.unsigned)},i.prototype.shiftRight=function(e){return i.isLong(e)&&(e=e.toInt()),0===(e&=63)?this:32>e?i.fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):i.fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},i.prototype.shiftRightUnsigned=function(e){if(i.isLong(e)&&(e=e.toInt()),e&=63,0===e)return this;var t=this.high;if(32>e){var r=this.low;return i.fromBits(r>>>e|t<<32-e,t>>>e,this.unsigned)}return 32===e?i.fromBits(t,0,this.unsigned):i.fromBits(t>>>e-32,0,this.unsigned)},i.prototype.toSigned=function(){return this.unsigned?new i(this.low,this.high,!1):this},i.prototype.toUnsigned=function(){return this.unsigned?this:new i(this.low,this.high,!0)},"function"==typeof e&&"object"==typeof t&&t&&"object"==typeof r&&r?t.exports=i:"function"==typeof define&&define.amd?define(function(){return i}):(n.dcodeIO=n.dcodeIO||{}).Long=i}(this)},{}],3:[function(e,t,r){t.exports=e("./dist/Long.js")},{"./dist/Long.js":2}]},{},[1]);var CryptoJS=CryptoJS||function(e,t){var r={},n=r.lib={},i=function(){},o=n.Base={extend:function(e){i.prototype=this;var t=new i;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=n.WordArray=o.extend({init:function(e,r){e=this.words=e||[],this.sigBytes=r!=t?r:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes;if(e=e.sigBytes,this.clamp(),n%4)for(var i=0;e>i;i++)t[n+i>>>2]|=(r[i>>>2]>>>24-8*(i%4)&255)<<24-8*((n+i)%4);else if(65535<r.length)for(i=0;e>i;i+=4)t[n+i>>>2]=r[i>>>2];else t.push.apply(t,r);return this.sigBytes+=e,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-8*(r%4),t.length=e.ceil(r/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var r=[],n=0;t>n;n+=4)r.push(4294967296*e.random()|0);return new s.init(r,t)}}),a=r.enc={},u=a.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var r=[],n=0;e>n;n++){var i=t[n>>>2]>>>24-8*(n%4)&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,r=[],n=0;t>n;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-4*(n%8);return new s.init(r,t/2)}},c=a.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var r=[],n=0;e>n;n++)r.push(String.fromCharCode(t[n>>>2]>>>24-8*(n%4)&255));return r.join("")},parse:function(e){for(var t=e.length,r=[],n=0;t>n;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-8*(n%4);return new s.init(r,t)}},h=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},f=n.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=h.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r=this._data,n=r.words,i=r.sigBytes,o=this.blockSize,a=i/(4*o),a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0);if(t=a*o,i=e.min(4*t,i),t){for(var u=0;t>u;u+=o)this._doProcessBlock(n,u);u=n.splice(0,t),r.sigBytes-=i}return new s.init(u,i)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});n.Hasher=f.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new g.HMAC.init(e,r).finalize(t)}}});var g=r.algo={};return r}(Math);!function(e){for(var t=CryptoJS,r=t.lib,n=r.WordArray,i=r.Hasher,r=t.algo,o=[],s=[],a=function(e){return 4294967296*(e-(0|e))|0},u=2,c=0;64>c;){var h;e:{h=u;for(var f=e.sqrt(h),g=2;f>=g;g++)if(!(h%g)){h=!1;break e}h=!0}h&&(8>c&&(o[c]=a(e.pow(u,.5))),s[c]=a(e.pow(u,1/3)),c++),u++}var l=[],r=r.SHA256=i.extend({_doReset:function(){this._hash=new n.init(o.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],o=r[2],a=r[3],u=r[4],c=r[5],h=r[6],f=r[7],g=0;64>g;g++){if(16>g)l[g]=0|e[t+g];else{var d=l[g-15],p=l[g-2];l[g]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+l[g-7]+((p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10)+l[g-16]}d=f+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&h)+s[g]+l[g],p=((n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22))+(n&i^n&o^i&o),f=h,h=c,c=u,u=a+d|0,a=o,o=i,i=n,n=d+p|0}r[0]=r[0]+n|0,r[1]=r[1]+i|0,r[2]=r[2]+o|0,r[3]=r[3]+a|0,r[4]=r[4]+u|0,r[5]=r[5]+c|0,r[6]=r[6]+h|0,r[7]=r[7]+f|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return r[i>>>5]|=128<<24-i%32,r[(i+64>>>9<<4)+14]=e.floor(n/4294967296),r[(i+64>>>9<<4)+15]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(r),t.HmacSHA256=i._createHmacHelper(r)}(Math);var queue=[],queue_max=5;forge.message.listen("add_queue",function(e){for(var t=!1,r=0;r<queue.length;r++)queue[r]==e&&(t=!0);t||(queue.length>=queue_max&&queue.shift(),queue.push(e))}),forge.message.listen("clear_queue",function(e){queue=[]}),forge.message.listen("check_queue",function(e,t){for(var r=!1,n=0;n<queue.length;n++)queue[n]==e&&(r=queue[n]);r?(console.log(!0),t(r)):(console.log(!1),t(!1))});var partial_data=null,partial_ttl=7200,partial_last_update=0,version="",data_api="https://sdata.joinhoney.com",batch_array=[],batch_ttl=12e5,batch_max=5,batch_start=0;forge.logging.debug=function(){},forge.message.listen("get_cookie",function(e,t){forge.is.chrome()&&chrome.cookies.get({url:e.url,name:e.name},function(e){t(e)})}),forge.message.listen("set_cookie",function(e,t){forge.is.chrome()&&chrome.cookies.set({url:e.url,name:e.name,value:e.value,domain:e.domain,path:e.path,expirationDate:e.expiration},function(e){t(e)})}),forge.message.listen("remove_cookie",function(e,t){forge.is.chrome()&&chrome.cookies.remove({url:e.url,name:e.name},function(e){t(e)})});var focus_lock=!1;forge.message.listen("show_launchpad",function(e){focus_lock||(focus_lock=!0,forge.message.toFocussed("show_launchpad_in_focussed","true"),setTimeout(function(){focus_lock=!1},200))}),forge.message.listen("get_partial_urls",function(e,t){t(1e3*partial_ttl+partial_last_update<Date.now()?null:partial_data)},function(e){reply(null)}),forge.message.listen("set_partial_urls",function(e){partial_last_update=Date.now(),partial_data=e}),forge.message.listen("solo_event",function(e,t){forge.request.ajax({url:data_api+"/ev/"+e.event_code,type:"POST",xhrFields:{withCredentials:!0},headers:{"X-referer":e.referer},contentType:"application/json",data:JSON.stringify({src:"extension",event:e.data})})}),forge.message.listen("array_events",function(e,t){forge.request.ajax({url:data_api+"/ev/"+e.event_code,type:"POST",xhrFields:{withCredentials:!0},contentType:"application/json",data:JSON.stringify({src:"extension",events:e.data_array})})}),forge.message.listen("bg_post",function(e,t){var r={};forge.request.ajax({url:e.url,type:"POST",data:JSON.stringify(e.data),contentType:"application/json",success:function(e){r.response=e,r.status="ok",t(r)},error:function(e){r.response=e.message,console.log("reply with "+e.message),console.log(e),r.status="error",t(r)}})}),forge.message.listen("batch_add",function(e){try{var t=e.product;version=e.v,batch_start||(batch_start=(new Date).getTime()),batch_array.push(t),batch_array.length>=batch_max&&send800(batch_array)}catch(r){}}),forge.message.listen("batch_check",function(e){batch_array.length>=batch_max?send800(batch_array):batch_start+batch_ttl<(new Date).getTime()&&batch_array.length>0&&send800(batch_array)}),forge.message.listen("post_801",function(e){forge.prefs.get("user_settings",function(t){(!t||t.prod_view_allowed)&&forge.request.ajax({type:"POST",url:data_api+"/he801",data:JSON.stringify(e),contentType:"application/json",success:function(e){forge.message.toFocussed("post_result",e)},error:function(e){forge.message.toFocussed("post_result",e)}})})}),forge.message.listen("post_802",function(e){forge.request.ajax({type:"POST",url:data_api+"/he802",data:JSON.stringify(e),contentType:"application/json",success:function(e){forge.message.toFocussed("post_result",e)},error:function(e){forge.message.toFocussed("post_result",e)}})}),forge.message.listen("he101",function(e){forge.request.ajax({type:"GET",url:data_api+"/he101",contentType:"application/json",success:function(e){forge.message.broadcast("debug","got response"+e)},error:function(e){forge.message.broadcast("debug",e)}})}),forge.logging.debug=function(){},forge.logging.info=function(){},forge.message.listen("post",function(e,t){forge.request.ajax({type:"POST",url:e.url,data:JSON.stringify(e.data),contentType:"application/json",success:function(e){t(e)},error:function(e){t(e)}})}),forge.message.listen("copy",function(e){var t=document.createElement("textarea");document.body.appendChild(t),t.value=e,t.focus(),t.select(),console.log(e),document.execCommand("Copy"),t.remove()}),forge.message.listen("generate_new_id",function(e){forge.message.toFocussed("allow_new_id",!0)});try{forge.is.chrome()&&(chrome.tabs.onCreated.addListener(function(e){chrome.browserAction.setPopup({tabId:e.id,popup:"src/html/popup.html"}),chrome.browserAction.setBadgeText({text:"",tabId:e.id})}),forge.message.listen("open_unfocused_tab",function(e){chrome.tabs.create({url:e,active:!1},function(e){var t=e.id;setTimeout(function(){var e=setInterval(function(){chrome.tabs.get(t,function(r){"loading"!=r.status&&(clearInterval(e),chrome.tabs.remove(t))})},500)},4e3)})}),forge.is.chrome()&&(chrome.runtime.onMessage.addListener(function(e,t,r){if(e.activateBrowserIcon){chrome.browserAction.setIcon({path:{38:"src/images/honey-icon-32.png"},tabId:t.tab.id});var n=parseInt(e.code_length)?e.code_length:"";chrome.browserAction.setBadgeText({text:""+n,tabId:t.tab.id}),chrome.browserAction.setBadgeBackgroundColor({color:[150,150,150,255],tabId:t.tab.id}),chrome.browserAction.setPopup({tabId:t.tab.id,popup:""})}}),chrome.browserAction.onClicked.addListener(function(e){chrome.browserAction.getPopup({tabId:e.id},function(e){e||forge.message.toFocussed("show_launchpad_in_focussed","true")})})),forge.message.listen("activateBrowserIcon",function(e){forge.is.chrome()&&chrome.tabs.getSelected(null,function(e){chrome.browserAction.setIcon({path:{38:"src/images/honey-icon-32.png"},tabId:e.id})})}),forge.message.listen("disableBrowserIcon",function(e){forge.is.chrome()&&chrome.tabs.getSelected(null,function(e){chrome.browserAction.setIcon({path:{19:"src/images/honey-icon-19d.png",38:"src/images/honey-icon-38d.png"},tabId:e.id})})}),forge.message.listen("setBadgeText",function(e){try{forge.is.chrome()&&chrome.tabs.getSelected(null,function(t){try{var r=chrome.runtime.lastError;if(r)return;chrome.browserAction.setBadgeText({text:e,tabId:t.id}),chrome.browserAction.setBadgeBackgroundColor({color:[150,150,150,255],tabId:t.id})}catch(n){}})}catch(t){console.log(t)}}),forge.message.listen("clearBadgeText",function(e){forge.is.chrome()&&chrome.browserAction.setBadgeText({text:""})}))}catch(e){}